<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PivotCalibrationVrepPlugin.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_1197876a19540712f3e74c4694e02d2d.html">grl</a></li><li class="navelem"><a class="el" href="dir_9c0f98a6e9a67e7f016b366d76e8e53e.html">vrep</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">PivotCalibrationVrepPlugin.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="PivotCalibrationVrepPlugin_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef _PIVOT_CALIBRATION_VREP_PLUGIN_HPP_</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define _PIVOT_CALIBRATION_VREP_PLUGIN_HPP_</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;boost/log/trivial.hpp&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;boost/exception/all.hpp&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;boost/algorithm/string.hpp&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Eigen_8hpp.html">grl/vrep/Eigen.hpp</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Vrep_8hpp.html">grl/vrep/Vrep.hpp</a>&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;TRTK/PivotCalibration.hpp&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="v__repLib_8h.html">v_repLib.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">/// @todo move elsewhere, because it will conflict with others&#39; implementations of outputting vectors</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="PivotCalibrationVrepPlugin_8hpp.html#a919c17d39ba93de24c5b492672fb775a">   19</a></span>&#160;<span class="keyword">inline</span> boost::log::formatting_ostream&amp; operator&lt;&lt;(boost::log::formatting_ostream&amp; out,  std::vector&lt;T&gt;&amp; v)</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    out &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordtype">size_t</span> last = v.size() - 1;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; v.size(); ++i) {</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        out &lt;&lt; v[i];</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <span class="keywordflow">if</span> (i != last) </div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;            out &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    }</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    out &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">return</span> out;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;}</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacegrl.html">grl</a> {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">/// Creates a complete vrep plugin object</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/// usage:</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/// @code</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">///    auto pivotCalib = std::make_shared&lt;grl::PivotCalibrationVrepPlugin&gt;();</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">///    pivotCalib-&gt;construct();</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">///    // move objects to new position</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/// @endcode</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/// @todo the rotation component may be different between the</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html">   45</a></span>&#160;<span class="comment"></span><span class="keyword">class </span><a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html">PivotCalibrationVrepPlugin</a> : <span class="keyword">public</span> std::enable_shared_from_this&lt;PivotCalibrationVrepPlugin&gt; {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#ae04816ce74177064de48291a101215dd">   48</a></span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#ae04816ce74177064de48291a101215dd">debug</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8">   50</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8">ParamIndex</a> {</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8a386feea3e9b30ef30a700eb6c3409d13">   51</a></span>&#160;        <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8a386feea3e9b30ef30a700eb6c3409d13">ToolTipToModifyName</a>,       <span class="comment">///&lt;  V-REP handle string for the tip of the tool that will be *modified*</span></div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8abfddde09b0044a23eac50dfaf06e7992">   52</a></span>&#160;<span class="comment"></span>        <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8abfddde09b0044a23eac50dfaf06e7992">ToolTipToMeasureName</a>,      <span class="comment">///&lt;  V-REP handle string for the tip of the tool that will be *measured*</span></div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8a9e51387928cbb6e84d58a7a0accf4882">   53</a></span>&#160;<span class="comment"></span>        <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8a9e51387928cbb6e84d58a7a0accf4882">ToolBaseToModifyName</a>,      <span class="comment">///&lt;  V-REP handle string for the base of the tool that will be *modified*</span></div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8abf344d1aaafb31ca437f143c3fb72df8">   54</a></span>&#160;<span class="comment"></span>        <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8abf344d1aaafb31ca437f143c3fb72df8">ToolBaseToMeasureName</a>,     <span class="comment">///&lt;  V-REP handle string for the base of the tool that will be *measured*</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span>    };</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    </div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keyword">typedef</span> std::tuple&lt;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        std::string,</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        std::string,</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        std::string,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        std::string</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#ac5c70866c69825307fefa18ccb14a6d4">   62</a></span>&#160;        &gt; <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#ac5c70866c69825307fefa18ccb14a6d4">Params</a>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    </div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    </div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#aa23f3af246276dba15a621b3a8a29297">   65</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#ac5c70866c69825307fefa18ccb14a6d4">Params</a> <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#aa23f3af246276dba15a621b3a8a29297">defaultParams</a>(){</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">return</span> std::make_tuple(</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                    <span class="stringliteral">&quot;RobotMillTip&quot;</span>              , <span class="comment">// ToolTipToModifyHandle,</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                    <span class="stringliteral">&quot;Fiducial#55&quot;</span>               , <span class="comment">// ToolTipToMeasureHandle,</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                    <span class="stringliteral">&quot;RobotFlangeTip&quot;</span>            , <span class="comment">// ToolTipHandle,</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                    <span class="stringliteral">&quot;Fiducial#22&quot;</span>                 <span class="comment">// ToolBaseHandle,</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                );</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">/// @todo allow KukaFRIThreadSeparator parameters to be updated</span></div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a0087c70adb34f9c74ec9ecf5e9c67de0">   75</a></span>&#160;<span class="comment"></span><a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a0087c70adb34f9c74ec9ecf5e9c67de0">PivotCalibrationVrepPlugin</a> (<a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#ac5c70866c69825307fefa18ccb14a6d4">Params</a> params = <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#aa23f3af246276dba15a621b3a8a29297">defaultParams</a>())</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      :</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      isFirstFrame(true),</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      frameCount(0),</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      params_(params)</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{<span class="comment"></span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">/// @todo figure out how to re-enable when .so isn&#39;t loaded</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"></span> <span class="comment">// initHandles();</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  </div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;}</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">/// construct() function completes initialization of the plugin</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">/// @todo move this into the actual constructor, but need to correctly handle or attach vrep shared libraries for unit tests.</span></div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a330c41debb895f2bd2ab2171548a11b7">   88</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a330c41debb895f2bd2ab2171548a11b7">construct</a>(){</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  initHandles();</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  </div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">// set the current transformEstimate to the initial estimate already in vrep</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">if</span>(allHandlesSet) transformEstimate = <a class="code" href="Eigen_8hpp.html#a2e770a01daf16df147d93b4a64f9d620">getObjectTransform</a>(toolTip,toolBase);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">/// Possible algorithms are:</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">///        TWO_STEP_PROCEDURE,         //!&lt; First, estimate the pivot point in global coordinates. Second, estimate the sought translation by computing the difference vector between the pivot point and the center of the sensor system; then take the mean.\n This algorithm is advantageous in the case of zero-mean noise.</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">///        COMBINATORICAL_APPROACH     //!&lt; Setup n equations that yield the pivot point from a single measurement using the sought (but unknown) translation. Eliminate the pivot point in the system of equations and finally solve for the sought translation. \n This algorithm is advantageous in the case of non-zero-mean noise (e.g. a systematic error).</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">/// If the algorithm string doesn&#39;t match an existing algorithm, this API will assume TWO_STEP_PROCEDURE.</span></div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a919ba1824214a1d92008a6714923ddfc">  100</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#a919ba1824214a1d92008a6714923ddfc">setAlgorithm</a>(std::string algorithm_){</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  algorithm = algorithm_;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// if (boost::iequals(algorithm, std::string(&quot;COMBINATORICAL_APPROACH&quot;))) algorithm = TRTK::PivotCalibration&lt;double&gt;::Algorithm::COMBINATORICAL_APPROACH;</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// else algorithm = TRTK::PivotCalibration&lt;double&gt;::Algorithm::TWO_STEP_PROCEDURE;</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#ad98081af7b7c4278de2b3ba86a3c808d">  106</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#ad98081af7b7c4278de2b3ba86a3c808d">addFrame</a>() {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   BOOST_LOG_TRIVIAL(trace) &lt;&lt; <span class="stringliteral">&quot;Adding pivot calibration frame #&quot;</span> &lt;&lt; ++frameCount &lt;&lt; std::endl;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    </div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keyword">auto</span> toolTipInToolBase    = <a class="code" href="Eigen_8hpp.html#a2e770a01daf16df147d93b4a64f9d620">getObjectTransform</a>(toolTip,toolBase);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    </div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">if</span>(isFirstFrame){</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      firstToolTipInToolBaseInverse             = toolTipInToolBase.inverse();</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      isFirstFrame = <span class="keyword">false</span>;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    </div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keyword">auto</span> toolTipInFirstTipBase      = firstToolTipInToolBaseInverse * toolTipInToolBase;        <span class="comment">// A_0_Inv * A_i</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    </div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    </div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    rvecsArm.push_back(     toolTipInFirstTipBase.rotation().matrix());</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    tvecsArm.push_back(     toolTipInFirstTipBase.translation()     );</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    </div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    </div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   <span class="keywordflow">if</span>(debug){</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   </div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;\ntoolTipInToolBase:\n&quot;</span> &lt;&lt; poseString(toolTipInToolBase) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;     </div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;\ntoolTipInFirstTipBase:\n&quot;</span> &lt;&lt; poseString(toolTipInFirstTipBase) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   </div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;     <span class="comment">// print simulation transfrom from tip to fiducial</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;     Eigen::Affine3d ToolTipToFiducial = <a class="code" href="Eigen_8hpp.html#a2e770a01daf16df147d93b4a64f9d620">getObjectTransform</a>(toolTip,toolBase);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;     BOOST_LOG_TRIVIAL(info) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; poseString(ToolTipToFiducial,<span class="stringliteral">&quot;expected ToolBaseToToolTip (simulation only): &quot;</span>) &lt;&lt; std::endl;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">/// @brief run solver to estimate the unknown transform and set the simulation to the estimated value</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">/// after calling addFrame a number of times in different positions and orientations</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">/// @todo evaluate if applyEstimate should not be called by this</span></div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#af2afa1e1c57b574b7cbbff73513e166e">  140</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#af2afa1e1c57b574b7cbbff73513e166e">estimatePivotOffset</a>(){</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  </div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   BOOST_LOG_TRIVIAL(trace) &lt;&lt; <span class="stringliteral">&quot;Running Pivot Calibration Estimate with the following numbers of entries in each category:  rvecsFiducial&quot;</span> &lt;&lt; <span class="stringliteral">&quot; rvecsArm: &quot;</span> &lt;&lt; rvecsArm.size() &lt;&lt; <span class="stringliteral">&quot; tvecsArm: &quot;</span> &lt;&lt; tvecsArm.size() &lt;&lt; std::endl;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   BOOST_VERIFY(allHandlesSet);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment"></span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">   /// TODO(ahundt) use Ransac pivot calibration wrapper because there will likely be noise</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"></span>   TRTK::PivotCalibrationTwoStep&lt;double&gt; pivotCalib;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   pivotCalib.setLocations(TRTK::make_range(tvecsArm));</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   pivotCalib.setRotations(TRTK::make_range(rvecsArm));</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <span class="comment"></span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">   /// TODO(ahundt) Allow selection of &quot;TWO_STEP_PROECDURE&quot; and &quot;COMBINATORIAL_APPROACH&quot; from V-REP LUA API</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"></span>   <span class="comment">//pivotCalib.setAlgorithm(&quot;TWO_STEP_PROCEDURE&quot;);</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   </div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   pivotCalib.compute();</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   </div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   transformEstimate.translation() = pivotCalib.getPivotPoint();</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    </div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    </div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// get fiducial in optical tracker base frame</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">int</span> ret = <a class="code" href="v__repLib_8h.html#a2dc312810b8462f2f591703866731cff">simGetObjectPosition</a>(toolTip, toolBase, detectedObjectPosition.begin());</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">if</span>(ret==-1) BOOST_THROW_EXCEPTION(std::runtime_error(<span class="stringliteral">&quot;PivotCalibrationVrepPlugin: Could not get position&quot;</span>));</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    ret = <a class="code" href="v__repLib_8h.html#a7a4ede5e380590b2a1662b5b177ed5ca">simGetObjectQuaternion</a>(toolTip, toolBase, detectedObjectQuaternion.begin());</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span>(ret==-1) BOOST_THROW_EXCEPTION(std::runtime_error(<span class="stringliteral">&quot;PivotCalibrationVrepPlugin: Could not get quaternion&quot;</span>));</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   <span class="keywordflow">if</span>(debug){</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;     <span class="comment">// print simulation transfrom from tip to fiducial</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;     Eigen::Affine3d ToolTipToFiducial = <a class="code" href="Eigen_8hpp.html#a2e770a01daf16df147d93b4a64f9d620">getObjectTransform</a>(toolTip,toolBase);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;     BOOST_LOG_TRIVIAL(info) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; poseString(ToolTipToFiducial,<span class="stringliteral">&quot;expected ToolBaseToToolTip (simulation only): &quot;</span>) &lt;&lt; std::endl;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   BOOST_LOG_TRIVIAL(info) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; poseString(transformEstimate,<span class="stringliteral">&quot;estimated toolBaseMeasured to toolTipMeasured:&quot;</span>) &lt;&lt; std::endl;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   </div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   <span class="comment">// print results</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   Eigen::Quaterniond eigenQuat(transformEstimate.rotation());</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   BOOST_LOG_TRIVIAL(info) &lt;&lt; <span class="stringliteral">&quot;Pivot Calibration Estimate quat wxyz\n: &quot;</span> &lt;&lt; eigenQuat.w() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; eigenQuat.x() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; eigenQuat.y() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; eigenQuat.z() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <span class="stringliteral">&quot; translation xyz: &quot;</span> &lt;&lt; transformEstimate.translation().x() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; transformEstimate.translation().y() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; transformEstimate.translation().z() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    </div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    BOOST_LOG_TRIVIAL(info) &lt;&lt; <span class="stringliteral">&quot;Optical Tracker Base Measured quat wxyz\n: &quot;</span> &lt;&lt; detectedObjectQuaternion[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; detectedObjectQuaternion[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; detectedObjectQuaternion[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; detectedObjectQuaternion[3] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <span class="stringliteral">&quot; translation xyz: &quot;</span> &lt;&lt; detectedObjectPosition[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; detectedObjectPosition[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; detectedObjectPosition[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  </div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;}</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">/// @brief  Will apply the stored estimate to the v-rep simulation value</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">/// A default transform is saved when construct() was called</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">/// so if no estimate has been found that will be used.</span></div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#ac61d4c4f74bd85c97b0d53561c01b4e2">  185</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#ac61d4c4f74bd85c97b0d53561c01b4e2">applyEstimate</a>(){</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   <span class="comment">// set transform between end effector and fiducial</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   <a class="code" href="Eigen_8hpp.html#af49b97d1296bb5f7eb88ec656af47bae">setObjectTransform</a>(toolTipToModify, toolBaseToModify, transformEstimate);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#ae1c5b899263c64abe55df01898df4aee">  191</a></span>&#160;Eigen::Affine3d <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#ae1c5b899263c64abe55df01898df4aee">getEstimate</a>(){</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <span class="keywordflow">return</span> transformEstimate;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">/// @brief Correct modified transform for measured optical tracker data</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">/// If real time transform measurements are happening applyEstimate will move the measured object</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">/// relative to the sensor and this puts the transform measurement back so the object</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">/// appears in its real position. However, if running in simulation only</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">/// the sensor will be in the correct position, so you don&#39;t want to call this.</span></div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="classgrl_1_1PivotCalibrationVrepPlugin.html#aa0f7c288e184c576a9936fe49f357002">  202</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#aa0f7c288e184c576a9936fe49f357002">restoreSensorPosition</a>(){</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   <span class="comment">// set real optical tracker position and orientation relative to the robot fiducial</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <a class="code" href="v__repLib_8h.html#ac9673dd6a3c9dcdc6b13e193504b9f3c">simSetObjectPosition</a>  (toolTip, toolBase, detectedObjectPosition.begin());</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   <a class="code" href="v__repLib_8h.html#adffdc912d66d5bd448181ddc32630db2">simSetObjectQuaternion</a>(toolTip, toolBase, detectedObjectQuaternion.begin());</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">/// @todo create a function that calls simGetObjectHandle and throws an exception when it fails</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">/// @todo throw an exception if any of the handles is -1</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"></span><span class="keywordtype">void</span> initHandles() {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    toolTip                         = grl::vrep::getHandleFromParam&lt;ToolTipToMeasureName&gt;                   (params_);                  <span class="comment">//Obtain ToolTip handle</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    toolBase                        = grl::vrep::getHandleFromParam&lt;ToolBaseToMeasureName&gt;                  (params_);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    toolTipToModify                 = grl::vrep::getHandleFromParam&lt;ToolTipToModifyName&gt;                    (params_);                  <span class="comment">//Obtain ToolTip handle</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    toolBaseToModify                = grl::vrep::getHandleFromParam&lt;ToolBaseToModifyName&gt;                   (params_);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    </div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    allHandlesSet  = <span class="keyword">true</span>;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">// TRTK::PivotCalibration&lt;double&gt;::Algorithm algorithm = TRTK::PivotCalibration&lt;double&gt;::Algorithm::TWO_STEP_PROCEDURE;</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;std::string algorithm = <span class="stringliteral">&quot;TWO_STEP_PROCEDURE&quot;</span>;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;std::vector&lt;typename TRTK::PivotCalibrationTwoStep&lt;double&gt;::Matrix3T &gt; rvecsArm;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;std::vector&lt;typename TRTK::PivotCalibrationTwoStep&lt;double&gt;::Vector3T &gt; tvecsArm;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keywordtype">bool</span> isFirstFrame;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;std::size_t frameCount;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;Eigen::Affine3d firstToolTipInToolBaseInverse;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">///</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"></span>std::array&lt;float,3&gt; detectedObjectPosition;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;std::array&lt;float,4&gt; detectedObjectQuaternion;<span class="comment"></span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">/// estimate transform between end effector and fiducial</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span>Eigen::Affine3d transformEstimate;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="keywordtype">int</span> toolTip = -1;                   <span class="comment">//Obtain ToolTip handle</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keywordtype">int</span> toolBase = -1;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keywordtype">int</span> toolTipToModify = -1;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keywordtype">int</span> toolBaseToModify = -1;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">//int ImplantCutPath = -1;</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">//int BallJointPath = -1;</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">//int bone = -1;</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keywordtype">bool</span> allHandlesSet = <span class="keyword">false</span>;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<a class="code" href="classgrl_1_1PivotCalibrationVrepPlugin.html#ac5c70866c69825307fefa18ccb14a6d4">Params</a> params_;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  EIGEN_MAKE_ALIGNED_OPERATOR_NEW</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;};</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  </div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_ac61d4c4f74bd85c97b0d53561c01b4e2"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#ac61d4c4f74bd85c97b0d53561c01b4e2">grl::PivotCalibrationVrepPlugin::applyEstimate</a></div><div class="ttdeci">void applyEstimate()</div><div class="ttdoc">Will apply the stored estimate to the v-rep simulation value. </div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00185">PivotCalibrationVrepPlugin.hpp:185</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_aa23f3af246276dba15a621b3a8a29297"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#aa23f3af246276dba15a621b3a8a29297">grl::PivotCalibrationVrepPlugin::defaultParams</a></div><div class="ttdeci">static const Params defaultParams()</div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00065">PivotCalibrationVrepPlugin.hpp:65</a></div></div>
<div class="ttc" id="Vrep_8hpp_html"><div class="ttname"><a href="Vrep_8hpp.html">Vrep.hpp</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_ac5c70866c69825307fefa18ccb14a6d4"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#ac5c70866c69825307fefa18ccb14a6d4">grl::PivotCalibrationVrepPlugin::Params</a></div><div class="ttdeci">std::tuple&lt; std::string, std::string, std::string, std::string &gt; Params</div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00062">PivotCalibrationVrepPlugin.hpp:62</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_aa0f7c288e184c576a9936fe49f357002"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#aa0f7c288e184c576a9936fe49f357002">grl::PivotCalibrationVrepPlugin::restoreSensorPosition</a></div><div class="ttdeci">void restoreSensorPosition()</div><div class="ttdoc">Correct modified transform for measured optical tracker data. </div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00202">PivotCalibrationVrepPlugin.hpp:202</a></div></div>
<div class="ttc" id="v__repLib_8h_html"><div class="ttname"><a href="v__repLib_8h.html">v_repLib.h</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_a9921637c6212d9e2d4f27d44eefce9b8abfddde09b0044a23eac50dfaf06e7992"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8abfddde09b0044a23eac50dfaf06e7992">grl::PivotCalibrationVrepPlugin::ToolTipToMeasureName</a></div><div class="ttdoc">V-REP handle string for the tip of the tool that will be measured </div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00052">PivotCalibrationVrepPlugin.hpp:52</a></div></div>
<div class="ttc" id="Eigen_8hpp_html_a2e770a01daf16df147d93b4a64f9d620"><div class="ttname"><a href="Eigen_8hpp.html#a2e770a01daf16df147d93b4a64f9d620">getObjectTransform</a></div><div class="ttdeci">Eigen::Affine3d getObjectTransform(int objectHandle, int relativeToObjectHandle=-1)</div><div class="ttdef"><b>Definition:</b> <a href="Eigen_8hpp_source.html#l00135">Eigen.hpp:135</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_ae04816ce74177064de48291a101215dd"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#ae04816ce74177064de48291a101215dd">grl::PivotCalibrationVrepPlugin::debug</a></div><div class="ttdeci">static const bool debug</div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00048">PivotCalibrationVrepPlugin.hpp:48</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_a9921637c6212d9e2d4f27d44eefce9b8a9e51387928cbb6e84d58a7a0accf4882"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8a9e51387928cbb6e84d58a7a0accf4882">grl::PivotCalibrationVrepPlugin::ToolBaseToModifyName</a></div><div class="ttdoc">V-REP handle string for the base of the tool that will be modified </div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00053">PivotCalibrationVrepPlugin.hpp:53</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_a9921637c6212d9e2d4f27d44eefce9b8a386feea3e9b30ef30a700eb6c3409d13"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8a386feea3e9b30ef30a700eb6c3409d13">grl::PivotCalibrationVrepPlugin::ToolTipToModifyName</a></div><div class="ttdoc">V-REP handle string for the tip of the tool that will be modified </div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00051">PivotCalibrationVrepPlugin.hpp:51</a></div></div>
<div class="ttc" id="v__repLib_8h_html_a2dc312810b8462f2f591703866731cff"><div class="ttname"><a href="v__repLib_8h.html#a2dc312810b8462f2f591703866731cff">simGetObjectPosition</a></div><div class="ttdeci">ptrSimGetObjectPosition simGetObjectPosition</div><div class="ttdef"><b>Definition:</b> <a href="v__repLib_8cpp_source.html#l00075">v_repLib.cpp:75</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_a330c41debb895f2bd2ab2171548a11b7"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#a330c41debb895f2bd2ab2171548a11b7">grl::PivotCalibrationVrepPlugin::construct</a></div><div class="ttdeci">void construct()</div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00088">PivotCalibrationVrepPlugin.hpp:88</a></div></div>
<div class="ttc" id="v__repLib_8h_html_ac9673dd6a3c9dcdc6b13e193504b9f3c"><div class="ttname"><a href="v__repLib_8h.html#ac9673dd6a3c9dcdc6b13e193504b9f3c">simSetObjectPosition</a></div><div class="ttdeci">ptrSimSetObjectPosition simSetObjectPosition</div><div class="ttdef"><b>Definition:</b> <a href="v__repLib_8cpp_source.html#l00076">v_repLib.cpp:76</a></div></div>
<div class="ttc" id="namespacegrl_html"><div class="ttname"><a href="namespacegrl.html">grl</a></div><div class="ttdef"><b>Definition:</b> <a href="ArmControlState__generated_8h_source.html#l00011">ArmControlState_generated.h:11</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_a919ba1824214a1d92008a6714923ddfc"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#a919ba1824214a1d92008a6714923ddfc">grl::PivotCalibrationVrepPlugin::setAlgorithm</a></div><div class="ttdeci">void setAlgorithm(std::string algorithm_)</div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00100">PivotCalibrationVrepPlugin.hpp:100</a></div></div>
<div class="ttc" id="Eigen_8hpp_html_af49b97d1296bb5f7eb88ec656af47bae"><div class="ttname"><a href="Eigen_8hpp.html#af49b97d1296bb5f7eb88ec656af47bae">setObjectTransform</a></div><div class="ttdeci">void setObjectTransform(int objectHandle, int relativeToObjectHandle, T &amp;transform)</div><div class="ttdef"><b>Definition:</b> <a href="Eigen_8hpp_source.html#l00117">Eigen.hpp:117</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_af2afa1e1c57b574b7cbbff73513e166e"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#af2afa1e1c57b574b7cbbff73513e166e">grl::PivotCalibrationVrepPlugin::estimatePivotOffset</a></div><div class="ttdeci">void estimatePivotOffset()</div><div class="ttdoc">run solver to estimate the unknown transform and set the simulation to the estimated value ...</div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00140">PivotCalibrationVrepPlugin.hpp:140</a></div></div>
<div class="ttc" id="v__repLib_8h_html_adffdc912d66d5bd448181ddc32630db2"><div class="ttname"><a href="v__repLib_8h.html#adffdc912d66d5bd448181ddc32630db2">simSetObjectQuaternion</a></div><div class="ttdeci">ptrSimSetObjectQuaternion simSetObjectQuaternion</div><div class="ttdef"><b>Definition:</b> <a href="v__repLib_8cpp_source.html#l00365">v_repLib.cpp:365</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_a9921637c6212d9e2d4f27d44eefce9b8abf344d1aaafb31ca437f143c3fb72df8"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8abf344d1aaafb31ca437f143c3fb72df8">grl::PivotCalibrationVrepPlugin::ToolBaseToMeasureName</a></div><div class="ttdoc">V-REP handle string for the base of the tool that will be measured </div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00054">PivotCalibrationVrepPlugin.hpp:54</a></div></div>
<div class="ttc" id="v__repLib_8h_html_a7a4ede5e380590b2a1662b5b177ed5ca"><div class="ttname"><a href="v__repLib_8h.html#a7a4ede5e380590b2a1662b5b177ed5ca">simGetObjectQuaternion</a></div><div class="ttdeci">ptrSimGetObjectQuaternion simGetObjectQuaternion</div><div class="ttdef"><b>Definition:</b> <a href="v__repLib_8cpp_source.html#l00364">v_repLib.cpp:364</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_a0087c70adb34f9c74ec9ecf5e9c67de0"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#a0087c70adb34f9c74ec9ecf5e9c67de0">grl::PivotCalibrationVrepPlugin::PivotCalibrationVrepPlugin</a></div><div class="ttdeci">PivotCalibrationVrepPlugin(Params params=defaultParams())</div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00075">PivotCalibrationVrepPlugin.hpp:75</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_ad98081af7b7c4278de2b3ba86a3c808d"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#ad98081af7b7c4278de2b3ba86a3c808d">grl::PivotCalibrationVrepPlugin::addFrame</a></div><div class="ttdeci">void addFrame()</div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00106">PivotCalibrationVrepPlugin.hpp:106</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_ae1c5b899263c64abe55df01898df4aee"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#ae1c5b899263c64abe55df01898df4aee">grl::PivotCalibrationVrepPlugin::getEstimate</a></div><div class="ttdeci">Eigen::Affine3d getEstimate()</div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00191">PivotCalibrationVrepPlugin.hpp:191</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html">grl::PivotCalibrationVrepPlugin</a></div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00045">PivotCalibrationVrepPlugin.hpp:45</a></div></div>
<div class="ttc" id="classgrl_1_1PivotCalibrationVrepPlugin_html_a9921637c6212d9e2d4f27d44eefce9b8"><div class="ttname"><a href="classgrl_1_1PivotCalibrationVrepPlugin.html#a9921637c6212d9e2d4f27d44eefce9b8">grl::PivotCalibrationVrepPlugin::ParamIndex</a></div><div class="ttdeci">ParamIndex</div><div class="ttdef"><b>Definition:</b> <a href="PivotCalibrationVrepPlugin_8hpp_source.html#l00050">PivotCalibrationVrepPlugin.hpp:50</a></div></div>
<div class="ttc" id="Eigen_8hpp_html"><div class="ttname"><a href="Eigen_8hpp.html">Eigen.hpp</a></div></div>
</div><!-- fragment --></div><!-- contents -->

<div class="footer">
&copy; 2015-2016 Andrew Hundt et al. Last updated on Tue Nov 15 2016 22:24:08. Created using <a href="http://www.doxygen.org/index.html">Doxygen</a> 1.8.12.
</div>
</body>
</html>
